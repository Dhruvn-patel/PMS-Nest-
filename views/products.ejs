<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
  <!-- <link rel="stylesheet" href="css/exam.css"> -->
  <link rel="stylesheet" href="/css/dashboard.css">
</head>


<body onload="navbar_changer('Products')">
  <section>
    <%- include('navbar.ejs') %>
      <div class="app-wrapper">
        <section>
          <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col ">
              <div class="card align-items-center">
                <div class="col-md-6 d-flex">
                  <div class="card-body p-4 p-lg-5 text-black">
                    <!-- <form enctype="multipart/form-data" onchange="" name="submitData"> -->
                    <div class="d-flex align-items-center mb-3 pb-1">
                      <i class="fas fa-cubes fa-2x me-3" style="color: #ff6219"></i>
                    </div>

                    <h2 class="fw-normal mb-3 pb-3">
                      Add Product
                    </h2>
                    <div class="form-outline mb-4">
                      <label class="form-label" for="form2Example17">Product Name :</label>
                      <input type="text" name="productName" id="productName" class="form-control form-control-lg" />
                      <p id="producterror" class="error"></p>
                    </div>
                    <div class="form-outline mb-4">
                      <label class="form-label" for="form2Example17">Category :</label>
                      <select class="form-select" aria-label="Default select example" name="categoryId" id="categoryId">
                        <p id="errorCategory" class="error"></p>
                        <option value="" selected>Select your category</option>


                        <%for(let i=0;i<categories.length;i++){%>
                          <option value="<%=categories[i].id%>" name="categoriesgoryId">
                            <%=categories[i].name%>
                          </option>

                          <%}%>
                      </select>
                    </div>
                    <div class="form-outline mb-4">
                      <label class="form-label" for="form2Example17">Product Description:</label>
                      <textarea name="" id="productDesc" cols="10" rows="5"
                        class="form-control form-control-lg"></textarea>
                      <p id="productDescerror" class="error"></p>
                    </div>
                    <label class="form-label" for="form2Example17">Product Price</label>
                    <div class="form-outline mb-4">
                      <input type="number" name="productPrice" id="productPrice" class="form-control form-control-lg" />

                    </div>
                    <div class="form-outline mb-4">
                      <label class="form-label" for="form2Example17"> Quantity</label>
                      <input type="number" name="Quantity" id="productQuantity" class="form-control form-control-lg" />

                    </div>
                    <div class="form-outline mb-4">
                      <label class="form-label" for="form2Example17">Product Image</label>
                      <input type="file" name="productImage" id="productImage" class="form-control form-control-lg" />
                    </div>
                    <div class="pt-1 mb-4">
                      <input type="submit" value="Add Product" class="btn btn-dark btn-lg btn-block"
                        onclick="submitData()" />
                    </div>
                    <!-- </form> -->
                  </div>
                </div>
              </div>
            </div>
          </div>

        </section>
        <script>
          let validateProductTitle_flag = 0, validateQunatity_flag = 0, validatePrice_flag = 0, validateDesc_flag = 0,
            validate_category = 0;
          let caterror = document.getElementById('errorCategory');
          let producterror = document.getElementById('producterror');
          let productDescerror = document.getElementById('productDescerror');

          function validationcategory() {

            if (catedata == undefined || catedata === "") {
              caterror.innerText = '*Please select the category ';
              caterror.style.color = 'red';
              validate_category = 0;
            }
            else {
              caterror.innerText = ' ';
              validate_category = 1
            }

          }

          function validationproduct() {


            console.log(proddata);
            if (proddata == "") {
              producterror.innerText = '*Please select the category ';
              producterror.style.color = 'red';
              validateProductTitle_flag = 0
            }
            else {
              producterror.innerText = ' ';
              validateProductTitle_flag = 1
            }


          }

          async function submitData() {

            let proddata = document.getElementById('productName').value;
            let productDesc = document.getElementById('productDesc').value;
            let cateIddata = document.getElementById('categoryId').value;
            let productQuantity = document.getElementById('productQuantity').value;
            let productPrice = document.getElementById('productPrice').value;
            let productImage = document.getElementById('productImage').value;
            console.log(proddata, productDesc, cateIddata, productQuantity, productPrice, productImage);

            const data = {
              ProductName: proddata,
              description: productDesc,
              price: productPrice,
              quantity: productQuantity,
              categoryId: cateIddata
            }
            const response = await fetch("/products/addProduct", {
              method: "POST",
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                data: data
              })
            })

            const datares = await response.json();
            console.log(datares);
          }
        </script>
      </div>
  </section>
  <script src="/js/navbar.js"></script>
  <script src="/js/product.js"></script>
</body>

</html>